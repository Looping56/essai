<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="style.css">
    <title>Récapitulatif - Lego</title>
</head>
<body>
    <header>VOTRE SÉLECTION FINALE</header>
    <div class="container">
        <div class="card">
            <h2>Récapitulatif pour <span id="nom-final"></span></h2>
            
            <div id="liste-recap" style="text-align: left; margin: 20px 0;">
                </div>

            <p style="color: var(--lego-green); font-weight: bold;">✅ Commande prête à être validée</p>
            
            <button class="btn-blue" onclick="window.location.href='dashboard.html'">
                Retour au Dashboard
            </button>
        </div>
    </div>

    <script>
        // 1. Vérification session
        const user = localStorage.getItem('user');
        if (!user) window.location.replace('index.html');
        document.getElementById('nom-final').innerText = user;

        // 2. Affichage des pièces choisies
        const listeDiv = document.getElementById('liste-recap');
        const donnees = JSON.parse(localStorage.getItem('ma_commande') || "[]");

        if (donnees.length === 0) {
            listeDiv.innerHTML = "<p style='color:red;'>Aucune pièce sélectionnée.</p>";
        } else {
            let html = "<table style='width:100%; border-collapse: collapse;'>";
            html += "<tr style='border-bottom: 2px solid #eee;'><th>Réf</th><th>Quantité</th></tr>";
            
            donnees.forEach(item => {
                html += `<tr style='border-bottom: 1px solid #eee;'>
                            <td style='padding:10px;'>${item.reference}</td>
                            <td style='padding:10px; text-align:center;'><b>${item.quantite}</b></td>
                         </tr>`;
            });
            html += "</table>";
            listeDiv.innerHTML = html;
        }
    </script>
</body>
</html>
