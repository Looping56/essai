
session_start();
if (!isset($_SESSION['admin_loge']) || $_SESSION['admin_loge'] !== true) {
    // Si pas connecté, on redirige vers le login
    header('Location: login.php');
    exit;
}


session_start();
// Sécurité : vérifier que c'est bien l'admin
if (!isset($_SESSION['admin_loge'])) exit;

$pdo = new PDO("mysql:host=localhost;dbname=gestion_lego;charset=utf8mb4", "root", "");

if (isset($_GET['action'])) {
    $nouvel_etat = ($_GET['statut'] == '1') ? '1' : '0';
    $cle = ($_GET['action'] == 'choix') ? 'etat_choix' : 'etat_final';

    $stmt = $pdo->prepare("UPDATE config_systeme SET valeur = ? WHERE cle = ?");
    $stmt->execute([$nouvel_etat, $cle]);
}

header('Location: admin.php'); // Retour à la page admin